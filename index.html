<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nomads Hideaway | Your Base Camp in the South</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightbox2@2.11.3/dist/css/lightbox.min.css">
    
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        :root {
            --mango: #FFB347;
            --leaf: #2E8B57;
            --railway: #E63946;
            --sand: #F9F7F2;
            --text: #2C3E50;
            --white: #ffffff;
        }

        /* BASE STYLES */
        * { margin: 0; padding: 0; box-sizing: border-box; scroll-behavior: smooth; }
        body { font-family: 'Inter', sans-serif; background-color: var(--sand); color: var(--text); line-height: 1.7; overflow-x: hidden; }
        h1, h2, h3, h4 { font-family: 'Playfair Display', serif; color: var(--leaf); }

        /* HEADER NAVIGATION */
        header.nav-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 30px;
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            width: 90%;
            max-width: 1200px;
            border-radius: 50px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .nav-logo { font-family: 'Playfair Display', serif; font-size: 1.2rem; font-weight: 700; color: var(--leaf); display: flex; align-items: center; gap: 10px; }
        .nav-links { display: flex; gap: 30px; }
        .nav-links a { text-decoration: none; color: var(--text); font-weight: 500; font-size: 0.95rem; }
        .nav-links a:hover { color: var(--mango); }
        
        .hamburger { display: none; flex-direction: column; gap: 5px; cursor: pointer; }
        .hamburger span { width: 25px; height: 3px; background: var(--text); border-radius: 2px; }

        /* HERO SECTION */
        .hero {
            height: 90vh;
            min-height: 500px;
            background: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url('img/nomads_24.jpg');
            background-size: cover;
            background-position: center;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: var(--white);
            padding: 20px;
        }

        .hero-content { max-width: 800px; }
        
        .hero-content h1 {
            font-size: 3.5rem;
            color: #ffffff;
            text-shadow: 0 4px 15px rgba(0,0,0,0.6);
            margin-bottom: 15px;
        }

        .hero-content p {
            font-size: 1.3rem;
            color: #f0f0f0;
            text-shadow: 0 2px 8px rgba(0,0,0,0.8);
            margin-bottom: 10px;
            font-weight: 400;
        }

        /* TYPEWRITER EFFECT */
        .typewriter-container {
            position: relative;
            display: inline-block;
            margin-top: 20px;
        }

        .typewriter-text {
            font-size: 2.2rem;
            color: #f0f0f0;
            text-shadow: 0 2px 8px rgba(0,0,0,0.8);
            margin: 0;
            font-weight: 400;
            letter-spacing: 0.5px;
            min-height: 50px;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 8px;
        }

        #typewriter {
            color: var(--mango);
            font-weight: 700;
            display: inline-block;
            min-width: 180px;
            text-decoration: underline;
            text-decoration-color: var(--leaf);
            text-decoration-thickness: 2px;
            text-underline-offset: 4px;            white-space: nowrap;        }

        .distance-indicator {
            display: inline-block;
            margin-left: 8px;
            padding: 10px 18px;
            background: rgba(46, 139, 87, 0.2);
            border-radius: 20px;
            font-size: 1.1rem;
            color: #ffffff;
            font-weight: 700;
            text-shadow: 0 1px 4px rgba(0,0,0,0.5);
            opacity: 0;
            transition: opacity 0.3s ease;
            white-space: nowrap;
        }

        .typewriter-cursor {
            display: inline-block;
            width: 3px;
            height: 38px;
            background: var(--mango);
            margin-left: 4px;
            animation: blink 1s infinite;
            vertical-align: middle;
        }

        @keyframes blink {
            0%, 49% { opacity: 1; }
            50%, 100% { opacity: 0; }
        }

        /* BOOKING BAR (Glassmorphism Orange) */
        .booking-bar {
            background: rgba(255, 179, 71, 0.95); 
            backdrop-filter: blur(10px);
            max-width: 1000px;
            margin: -80px auto 0;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            position: relative;
            z-index: 10;
            display: grid;
            grid-template-columns: 1fr 1fr auto;
            gap: 20px;
            align-items: end;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .input-group label { color: #333; font-weight: 700; margin-bottom: 8px; display: flex; align-items: center; gap: 8px; font-size: 0.9rem; }
        .input-group input { width: 100%; padding: 15px; border: none; border-radius: 10px; font-family: 'Inter'; font-size: 1rem; background: white; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }

        .btn-primary {
            background-color: var(--leaf);
            color: white;
            padding: 15px 35px;
            border: none;
            border-radius: 50px;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        .btn-primary:hover { transform: translateY(-3px); box-shadow: 0 10px 20px rgba(46, 139, 87, 0.3); }
        .btn-primary:disabled { background-color: #ccc; cursor: not-allowed; transform: none; }

        /* GENERAL CONTAINERS */
        .container { max-width: 1200px; margin: 0 auto; padding: 60px 20px; }

        /* OTA STRIP */
        .ota-strip { background: #fff; padding: 40px 0; text-align: center; border-bottom: 1px solid #eee; margin-top: 40px; }
        .ota-logos { display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; margin-top: 20px; }
        .ota-btn { padding: 10px 20px; border: 1px solid #ddd; border-radius: 8px; text-decoration: none; color: #555; display: flex; align-items: center; gap: 8px; font-weight: 600; font-size: 0.9rem; }
        .ota-btn:hover { border-color: var(--mango); color: var(--mango); }

        /* RESULTS BOX */
        .price-result { 
            grid-column: 1 / -1; 
            background: #fff; 
            padding: 20px; 
            border-radius: 15px; 
            margin-top: 10px; 
            display: none; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            text-align: center;
        }
        .price-row { display: flex; justify-content: space-between; margin: 10px 0; border-bottom: 1px dashed #eee; padding-bottom: 10px; }
        .strike { text-decoration: line-through; color: #999; }
        .final-price { color: var(--leaf); font-weight: 800; font-size: 1.4rem; }

        /* CONNECTIVITY */
        .connect-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 40px; align-items: center; }
        .connect-info h2 { font-size: 2.5rem; margin-bottom: 20px; }
        .highlight-box { display: flex; align-items: flex-start; gap: 15px; background: #fff0f0; border-left: 5px solid var(--railway); padding: 20px; border-radius: 0 10px 10px 0; margin-top: 20px; }

        /* BEACHES */
        .beach-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; margin-top: 30px; }
        .beach-card { background: var(--white); border-radius: 15px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.05); transition: transform 0.3s; }
        .beach-card:hover { transform: translateY(-5px); }
        .beach-img { height: 200px; background-size: cover; background-position: center; position: relative; }
        .distance-tag { position: absolute; bottom: 15px; left: 15px; background: var(--white); padding: 5px 12px; border-radius: 20px; font-size: 0.8rem; font-weight: 700; color: var(--text); }
        .beach-content { padding: 25px; }

        /* GALLERY */
        .gallery-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 15px; margin-top: 30px; }
        .gallery-item { aspect-ratio: 1; overflow: hidden; border-radius: 12px; cursor: pointer; }
        .gallery-item img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s; }
        .gallery-item:hover img { transform: scale(1.05); }

        /* CAROUSEL */
        .carousel-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin: 30px auto;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }

        .carousel-wrapper {
            position: relative;
            width: 100%;
            aspect-ratio: 4/3;
            overflow: hidden;
        }

        .carousel-slide {
            position: absolute;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            opacity: 0;
            transition: opacity 0.8s ease-in-out;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .carousel-slide.active {
            opacity: 1;
        }

        .carousel-slide:hover {
            filter: brightness(0.9);
        }

        .carousel-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.85);
            border: none;
            padding: 12px 16px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            transition: all 0.3s ease;
            color: var(--text);
            backdrop-filter: blur(5px);
        }

        .carousel-btn:hover {
            background: rgba(255, 255, 255, 1);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
            transform: translateY(-50%) scale(1.1);
        }

        .carousel-prev {
            left: 15px;
        }

        .carousel-next {
            right: 15px;
        }

        .carousel-dots {
            position: absolute;
            bottom: 15px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 8px;
            z-index: 10;
        }

        .dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid rgba(255, 255, 255, 0.8);
        }

        .dot.active {
            background: var(--mango);
            border-color: var(--mango);
            transform: scale(1.3);
        }

        /* LIGHTBOX MODAL */
        .lightbox-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }

        .lightbox-modal.active {
            display: flex;
        }

        .lightbox-content {
            position: relative;
            max-width: 90%;
            max-height: 90vh;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: zoomIn 0.3s ease;
        }

        #lightbox-image {
            width: 100%;
            height: auto;
            max-height: 85vh;
            object-fit: contain;
            border-radius: 10px;
        }

        .lightbox-close {
            position: absolute;
            top: -50px;
            right: 0;
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            padding: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            z-index: 2001;
        }

        .lightbox-close:hover {
            transform: scale(1.2);
            color: var(--mango);
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes zoomIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        /* OWNERS */
        .owners-section { background: var(--white); padding: 60px 20px; text-align: center; }
        .couple-photo-container { width: 250px; height: 250px; border-radius: 50%; overflow: hidden; margin: 0 auto 30px; border: 5px solid var(--mango); }
        .couple-photo-container img { width: 100%; height: 100%; object-fit: cover; }

        /* INSTAGRAM */
        .insta-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; margin-top: 30px; }
        .insta-item { aspect-ratio: 1; overflow: hidden; border-radius: 10px; }
        .insta-item img { width: 100%; height: 100%; object-fit: cover; }

        /* PARTNER BUSINESSES */
        .partners-section { 
            background: linear-gradient(135deg, rgba(255,179,71,0.05) 0%, rgba(46,139,87,0.05) 100%);
            padding: 60px 20px;
            margin: 60px 0;
        }

        .partners-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .partner-card {
            background: white;
            border-radius: 20px;
            padding: 40px 30px;
            text-align: center;
            border: 2px solid rgba(255,179,71,0.15);
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }

        .partner-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 35px rgba(0,0,0,0.12);
            border-color: var(--mango);
        }

        .partner-logo-container {
            width: 120px;
            height: 120px;
            margin: 0 auto 25px;
            background: linear-gradient(135deg, rgba(255,179,71,0.1), rgba(46,139,87,0.1));
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px dashed var(--mango);
        }

        .partner-logo {
            max-width: 100px;
            max-height: 100px;
            object-fit: contain;
        }

        .partner-card h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: var(--text);
        }

        .partner-category {
            color: var(--mango);
            font-weight: 700;
            font-size: 0.95rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .partner-description {
            color: #666;
            font-size: 0.95rem;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .partner-perks {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 25px;
        }

        .perk {
            color: var(--leaf);
            font-size: 0.9rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .partner-btn {
            display: inline-block;
            padding: 12px 30px;
            background: linear-gradient(135deg, var(--mango), #FFD580);
            color: white;
            text-decoration: none;
            border-radius: 50px;
            font-weight: 700;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
        }

        .partner-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 20px rgba(255,179,71,0.3);
        }

        /* FOOTER */
        footer { background: var(--text); color: #aaa; padding: 40px 20px; text-align: center; margin-top: 60px; }
        footer h3 { color: var(--white); margin-bottom: 10px; }

        /* MOBILE MENU */
        @media (max-width: 768px) {
            header.nav-bar { top: 0; width: 100%; border-radius: 0 0 20px 20px; }
            .nav-links { display: none; flex-direction: column; position: absolute; top: 70px; left: 0; width: 100%; background: white; padding: 20px; box-shadow: 0 10px 20px rgba(0,0,0,0.1); text-align: center; }
            .nav-links.active { display: flex; }
            .hamburger { display: flex; }
            .booking-bar { grid-template-columns: 1fr; margin-top: 20px; width: 90%; }
            .hero-content h1 { font-size: 2.5rem; }
            .connect-grid { grid-template-columns: 1fr; }
            
            .partners-grid { grid-template-columns: 1fr; gap: 20px; }
            .partner-card { padding: 30px 20px; }
        }

        @media (max-width: 480px) {
            .typewriter-text {
                font-size: 1.6rem;
                min-height: 80px;
                flex-direction: column;
                align-items: flex-start;
            }

            .distance-indicator {
                margin-left: 0;
                margin-top: 10px;
                display: block;
                width: 100%;
                text-align: center;
            }
            .partners-section { padding: 40px 15px; margin: 40px 0; }
            .partner-card { padding: 25px 15px; }
            .partner-logo-container { width: 100px; height: 100px; margin-bottom: 20px; }
            .partner-card h3 { font-size: 1.3rem; }
            .partner-description { font-size: 0.9rem; }
            .partner-perks { font-size: 0.85rem; }
        }
    </style>
</head>
<body>

    <header class="nav-bar">
        <div class="nav-logo">
            <img src="img/logo.png" style="height: 35px; width: auto;" alt="Logo" onerror="this.style.display='none'"> 
            <span>Nomads Hideaway</span>
        </div>
        <div class="hamburger" onclick="toggleMenu()">
            <span></span><span></span><span></span>
        </div>
        <nav class="nav-links" id="navLinks">
            <a href="#book" onclick="toggleMenu()">Book Now</a>
            <a href="#beaches" onclick="toggleMenu()">Beaches</a>
            <a href="#gallery" onclick="toggleMenu()">Gallery</a>
            <a href="#owners" onclick="toggleMenu()">Hosts</a>
        </nav>
    </header>

    <div class="hero">
        <div class="hero-content">
            <h1>Your Base Camp in the South</h1>
            <div class="typewriter-container">
                <p class="typewriter-text"><span id="typewriter"><span class="typewriter-cursor">|</span></span><span class="distance-indicator" id="distance-tag"></span></p>
            </div>
        </div>
    </div>

    <div class="booking-bar" id="book">
        <div class="input-group">
            <label><i data-lucide="calendar" size="16"></i> Check In</label>
            <input type="text" id="checkin" placeholder="Select Date">
        </div>
        <div class="input-group">
            <label><i data-lucide="calendar" size="16"></i> Check Out</label>
            <input type="text" id="checkout" placeholder="Select Date">
        </div>
        <button onclick="checkAvailability()" class="btn-primary" id="searchBtn">Check Availability</button>

        <div class="price-result" id="result-area">
            <h3 id="status-msg">Checking...</h3>
            <div id="price-box" style="display:none;">
                <div class="price-row">
                    <span>OTA Price (approx):</span>
                    <span class="strike" id="ota-price">$0</span>
                </div>
                <div class="price-row">
                    <span><strong>Direct Price:</strong></span>
                    <span class="final-price" id="direct-price">$0</span>
                </div>
                <p style="font-size: 0.9rem; color: var(--leaf); margin: 15px 0;">You save ~15% by booking direct.</p>
                <button onclick="window.open('https://buy.stripe.com/YOUR_STRIPE_LINK', '_blank')" class="btn-primary" style="width: 100%;">Book Securely via Stripe</button>
            </div>
        </div>
    </div>

    <div class="ota-strip">
        <div class="container" style="padding: 0;">
            <p style="font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px; color: #888;">Or compare us on</p>
            <div class="ota-logos">
                <a href="https://www.airbnb.com.sg/rooms/1455899583985865476" target="_blank" class="ota-btn"><i data-lucide="home"></i> Airbnb</a>
                <a href="https://www.booking.com/Share-ZnfqtK" target="_blank" class="ota-btn"><i data-lucide="bed"></i> Booking.com</a>
                <a href="https://www.agoda.com/sl/JrA6uDBUArP" target="_blank" class="ota-btn"><i data-lucide="map"></i> Agoda</a>
                <a href="https://www.trip.com/w/nzZiscnPDT2" target="_blank" class="ota-btn"><i data-lucide="globe"></i> Trip.com</a>
            </div>
        </div>
    </div>

    <section class="container">
        <div class="connect-grid">
            <div class="connect-info">
                <h2>Connected to Everything. <br>Far from the Noise.</h2>
                <p>Unlike isolated tourist hotels, Nomads Hideaway is located in a real Sri Lankan neighborhood. You get the peace of a private garden villa with unmatched connectivity.</p>
                
                <div class="highlight-box">
                    <i data-lucide="train" size="28" color="#E63946"></i>
                    <div>
                        <h4 style="color:var(--railway); margin-bottom: 5px;">Matara Railway Station</h4>
                        <p style="margin:0; font-size:0.9rem;">Just <strong>300m / 5 min walk</strong> away. The train is your gateway to the entire island.</p>
                    </div>
                </div>
                <div style="margin-top: 30px;">
                    <p><i data-lucide="map-pin" size="16"></i> <strong>Expressway Entrance:</strong> 5 mins drive</p>
                    <p><i data-lucide="shopping-bag" size="16"></i> <strong>Supermarkets & City Center:</strong> 5 mins tuk-tuk</p>
                </div>
            </div>
            <div class="connect-img">
                <img src="https://images.unsplash.com/photo-1596627828236-8968925d62b5?q=80&w=2070&auto=format&fit=crop" style="width:100%; border-radius: 20px;" alt="Sri Lanka Train" onerror="handleImageError(this)">
            </div>
        </div>
    </section>

    <section class="container" id="beaches">
        <h2 style="text-align: center;">Your Base Camp for the South Coast</h2>
        <p style="text-align: center; color: #666; margin-bottom: 40px;">Wake up, grab a tuk-tuk, and pick your vibe.</p>
        <div class="beach-grid">
            <div class="beach-card">
                <div class="beach-img" style="background-image: url('https://images.unsplash.com/photo-1582650630740-4c740c49495b?q=80&w=2070&auto=format&fit=crop');">
                    <span class="distance-tag">3 KM (10 Mins)</span>
                </div>
                <div class="beach-content">
                    <h3>Polhena Beach</h3>
                    <p>Calm waters protected by a reef. Famous for <strong>Swimming with Sea Turtles</strong>. Perfect for snorkeling.</p>
                </div>
            </div>
            <div class="beach-card">
                <div class="beach-img" style="background-image: url('https://images.unsplash.com/photo-1537550839958-38069d3f18df?q=80&w=2070&auto=format&fit=crop');">
                    <span class="distance-tag">4 KM (12 Mins)</span>
                </div>
                <div class="beach-content">
                    <h3>Madiha Beach</h3>
                    <p>The hip "Surfer's Village". Excellent coffee shops, local vibes, and quality surf breaks for intermediates.</p>
                </div>
            </div>
            <div class="beach-card">
                <div class="beach-img" style="background-image: url('https://images.unsplash.com/photo-1502680390469-be75c86b636f?q=80&w=2070&auto=format&fit=crop');">
                    <span class="distance-tag">6 KM (15 Mins)</span>
                </div>
                <div class="beach-content">
                    <h3>SK Town Beach</h3>
                    <p>A hidden gem with quiet, vast sandy shores. Excellent for <strong>Beginner Surfing</strong> without crowds.</p>
                </div>
            </div>
            <div class="beach-card">
                <div class="beach-img" style="background-image: url('https://images.unsplash.com/photo-1566373760359-22cb159b3513?q=80&w=2070&auto=format&fit=crop');">
                    <span class="distance-tag">10 KM (20 Mins)</span>
                </div>
                <div class="beach-content">
                    <h3>Mirissa</h3>
                    <p>Famous for <strong>Whale Watching</strong> and vibrant nightlife. Sunset cocktails at Coconut Tree Hill are legendary.</p>
                </div>
            </div>
            <div class="beach-card">
                <div class="beach-img" style="background-image: url('https://images.unsplash.com/photo-1622306467657-3a13723321db?q=80&w=2000&auto=format&fit=crop');">
                    <span class="distance-tag">15 KM (25 Mins)</span>
                </div>
                <div class="beach-content">
                    <h3>Weligama Bay</h3>
                    <p>The "Capital of Learning to Surf". Gentle long waves and home to the iconic Stilt Fishermen. Perfect for learners.</p>
                </div>
            </div>
            <div class="beach-card">
                <div class="beach-img" style="background-image: url('https://images.unsplash.com/photo-1588691898747-81d3d62325c3?q=80&w=2000&auto=format&fit=crop');">
                    <span class="distance-tag">20 KM (35 Mins)</span>
                </div>
                <div class="beach-content">
                    <h3>Hiriketiya</h3>
                    <p>A stunning horseshoe bay with jungle vibes. Hip cafes, yoga studios, and a very relaxed bohemian atmosphere.</p>
                </div>
            </div>
            <div class="beach-card">
                <div class="beach-img" style="background-image: url('https://images.unsplash.com/photo-1507525428034-b723cf961d3e?q=80&w=2070&auto=format&fit=crop');">
                    <span class="distance-tag">2 KM (5 Mins)</span>
                </div>
                <div class="beach-content">
                    <h3>Matara Beach</h3>
                    <p>Your closest beach! Scenic coastal views with local restaurants and calm morning swims. Great for sunrise walks.</p>
                </div>
            </div>
            <div class="beach-card">
                <div class="beach-img" style="background-image: url('https://images.unsplash.com/photo-1505142468610-359e7d316be0?q=80&w=2070&auto=format&fit=crop');">
                    <span class="distance-tag">25 KM (40 Mins)</span>
                </div>
                <div class="beach-content">
                    <h3>Talalla Beach</h3>
                    <p>A quiet and secluded beach with dramatic cliff views. Perfect for those seeking peace and pristine natural beauty.</p>
                </div>
            </div>
            <div class="beach-card">
                <div class="beach-img" style="background-image: url('https://images.unsplash.com/photo-1559827260-dc66d52bef19?q=80&w=2070&auto=format&fit=crop');">
                    <span class="distance-tag">8 KM (18 Mins)</span>
                </div>
                <div class="beach-content">
                    <h3>Duwili Ulpatha Beach</h3>
                    <p>A lesser-known pristine beach with golden sand and calm waters. Ideal for swimming and beach picnics away from tourists.</p>
                </div>
            </div>
        </div>
    </section>

    <section class="container" id="gallery">
        <h2 style="text-align: center;">Experience the Villa</h2>
        <div class="carousel-container">
            <div class="carousel-wrapper">
                <div class="carousel-slide" style="background-image: url('img/nomads_2.jpg');" onclick="openLightbox('img/nomads_2.jpg')"></div>
                <div class="carousel-slide" style="background-image: url('img/nomads_4.jpg');" onclick="openLightbox('img/nomads_4.jpg')"></div>
                <div class="carousel-slide" style="background-image: url('img/nomads_5.jpg');" onclick="openLightbox('img/nomads_5.jpg')"></div>
                <div class="carousel-slide" style="background-image: url('img/nomads_6.jpg');" onclick="openLightbox('img/nomads_6.jpg')"></div>
                <div class="carousel-slide" style="background-image: url('img/nomads_7.jpg');" onclick="openLightbox('img/nomads_7.jpg')"></div>
                <div class="carousel-slide" style="background-image: url('img/nomads_8.jpg');" onclick="openLightbox('img/nomads_8.jpg')"></div>
                <div class="carousel-slide" style="background-image: url('img/nomads_9.jpg');" onclick="openLightbox('img/nomads_9.jpg')"></div>
                <div class="carousel-slide" style="background-image: url('img/nomads_10.jpg');" onclick="openLightbox('img/nomads_10.jpg')"></div>
                <div class="carousel-slide" style="background-image: url('img/nomads_15.jpg');" onclick="openLightbox('img/nomads_15.jpg')"></div>
                <div class="carousel-slide" style="background-image: url('img/nomads_16.jpg');" onclick="openLightbox('img/nomads_16.jpg')"></div>
                <div class="carousel-slide" style="background-image: url('img/nomads_18.jpg');" onclick="openLightbox('img/nomads_18.jpg')"></div>
                <div class="carousel-slide" style="background-image: url('img/nomads_19.jpg');" onclick="openLightbox('img/nomads_19.jpg')"></div>
                <div class="carousel-slide" style="background-image: url('img/nomads_20.jpg');" onclick="openLightbox('img/nomads_20.jpg')"></div>
                <div class="carousel-slide" style="background-image: url('img/nomads_24.jpg');" onclick="openLightbox('img/nomads_24.jpg')"></div>
            </div>
            <button class="carousel-btn carousel-prev" onclick="prevSlide()"><i data-lucide="chevron-left" size="32"></i></button>
            <button class="carousel-btn carousel-next" onclick="nextSlide()"><i data-lucide="chevron-right" size="32"></i></button>
            <div class="carousel-dots" id="dotsContainer"></div>
        </div>
    </section>

    <!-- LIGHTBOX MODAL -->
    <div id="lightbox-modal" class="lightbox-modal" onclick="closeLightbox()">
        <div class="lightbox-content" onclick="event.stopPropagation()">
            <img id="lightbox-image" src="" alt="Gallery Image">
            <button class="lightbox-close" onclick="closeLightbox()"><i data-lucide="x" size="32"></i></button>
        </div>
    </div>

    <section class="owners-section" id="owners">
        <div class="couple-photo-container">
            <img src="img/ammanthaththa.jpg" alt="Priyanka & Lionel" onerror="handleImageError(this)">
        </div>
        <h2>Meet Your Hosts</h2>
        <p style="max-width: 700px; margin: 0 auto; color: #666;">Priyanka and Lionel created Nomads Hideaway to share their love for Sri Lankan hospitality. Whether you need local tips or fresh fruit from the garden, they are here to make your stay unforgettable.</p>
    </section>

    <!-- GUEST REVIEWS SECTION -->
    <section class="container" style="text-align: center; padding-top: 60px;">
        <h2 style="margin-bottom: 40px;">What Our Guests Say</h2>
        <p style="color: #666; margin-bottom: 40px; max-width: 600px; margin-left: auto; margin-right: auto;">Authentic reviews from travelers who've experienced Nomads Hideaway. Read verified reviews from Booking.com, Airbnb, and more.</p>
        <div class="elfsight-app-73992642-0d9c-4ec3-b7fc-29774785b662" data-elfsight-app-lazy></div>
    </section>

    <!-- PARTNER BUSINESSES -->
    <section class="partners-section">
        <div class="container">
            <h2 style="text-align: center; margin-bottom: 50px;">Explore Local Partnerships</h2>
            
            <div class="partners-grid">
                <!-- RideX Hub Partnership -->
                <div class="partner-card">
                    <div class="partner-logo-container">
                        <img src="img/ridexhub_logo.webp" alt="RideXHub" class="partner-logo" onerror="handleImageError(this)">
                    </div>
                    <h3>RideXHub</h3>
                    <p class="partner-category"><i data-lucide="bike" size="16" style="display: inline; margin-right: 5px;"></i> Motorbike & Scooter Rentals</p>
                    <p class="partner-description">Explore Sri Lanka on two wheels! We've partnered with RideXHub to offer our guests exclusive discounts on hassle-free, deposit-free bike rentals with free home delivery to your villa.</p>
                    <div class="partner-perks">
                        <span class="perk"><i data-lucide="check-circle" size="14"></i> No Deposit Required</span>
                        <span class="perk"><i data-lucide="check-circle" size="14"></i> Free Delivery & Pickup</span>
                        <span class="perk"><i data-lucide="check-circle" size="14"></i> Guest Discount Available</span>
                    </div>
                    <a href="http://ridexhub.com/" target="_blank" class="partner-btn">Visit RideXHub</a>
                </div>

                <!-- Matara Spice Partnership -->
                <div class="partner-card">
                    <div class="partner-logo-container">
                        <img src="img/MSCo_logs.png" alt="Matara Spice" class="partner-logo" onerror="handleImageError(this)">
                    </div>
                    <h3>Matara Spice</h3>
                    <p class="partner-category"><i data-lucide="leaf" size="16" style="display: inline; margin-right: 5px;"></i> Premium Spices</p>
                    <p class="partner-description">Authentic Sri Lankan spices sourced from our family business. Bring home the essence of Sri Lanka: premium cinnamon, black pepper, cloves, cardamom, nutmeg, and much more.</p>
                    <div class="partner-perks">
                        <span class="perk"><i data-lucide="check-circle" size="14"></i> Farm-Fresh Quality</span>
                        <span class="perk"><i data-lucide="check-circle" size="14"></i> Family-Run Since Generations</span>
                        <span class="perk"><i data-lucide="check-circle" size="14"></i> Direct from Matara</span>
                    </div>
                    <a href="https://mataraspice.com/" target="_blank" class="partner-btn">Visit Matara Spice</a>
                </div>
            </div>
        </div>
    </section>

    <section class="container">
        <h2 style="text-align: center; margin-bottom: 20px;">Find Us</h2>
        <div style="width: 100%; height: 400px; border-radius: 20px; overflow: hidden;">
             <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3967.005!2d80.540306!3d5.952389!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3ae133f5b1b1b1b1%3A0x1b1b1b1b1b1b1b1b!2s87A%20Lumbini%2C%20Rahula%20Road%2C%20Matara!5e0!3m2!1sen!2slk!4v1642000000000" width="100%" height="100%" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
        </div>
    </section>

    <footer>
        <h3>Nomads Hideaway</h3>
        <p>87A Lumbini, Rahula Road, Matara 81000, Sri Lanka</p>
        <p><i data-lucide="phone" size="14"></i> Priyanka: +94 77 947 9900 | <i data-lucide="message-circle" size="14"></i> Thushara: +65 9425 2874</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/lightbox2@2.11.3/dist/js/lightbox.min.js"></script>
    <!-- Elfsight All-in-One Reviews -->
    <script src="https://elfsightcdn.com/platform.js" async></script>
    <script>
        // Load configuration from JSON
        let villaConfig = {};
        let BEACHES_CONFIG = [];

        // Fetch config and initialize
        fetch('config.json')
            .then(response => response.json())
            .then(data => {
                villaConfig = data;
                BEACHES_CONFIG = data.typewriterBeaches;
                initTypewriter();
                initCarouselOnLoad();
            })
            .catch(error => console.error('Error loading config:', error));

        // Wait for Lucide icons to load
        document.addEventListener('DOMContentLoaded', () => {
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        });

        // TYPEWRITER EFFECT
        let currentIndex = 0;
        let isDeleting = false;
        let textContent = '';
        let typewriterEl = null;
        let distanceEl = null;
        const typeSpeed = 80;
        const deleteSpeed = 50;
        const pauseTime = 2500;

        function initTypewriter() {
            typewriterEl = document.getElementById('typewriter');
            distanceEl = document.getElementById('distance-tag');
            if (typewriterEl && BEACHES_CONFIG.length > 0) {
                setTimeout(typeWriter, 500);
            }
        }

        function getBeachEmojis(tags) {
            return tags.join(' ');
        }

        function typeWriter() {
            if (!typewriterEl || BEACHES_CONFIG.length === 0) return;
            
            const beach = BEACHES_CONFIG[currentIndex];
            const fullText = beach.name;

            if (!isDeleting) {
                // Typing
                textContent = fullText.substring(0, textContent.length + 1);
                typewriterEl.innerHTML = textContent + '<span class="typewriter-cursor">|</span>';
                
                if (textContent === fullText) {
                    // Show distance, time, and emojis when fully typed
                    const emojis = getBeachEmojis(beach.tags);
                    distanceEl.textContent = emojis + ' ' + beach.distance + ' Â· ' + beach.time;
                    distanceEl.style.opacity = '1';
                    isDeleting = true;
                    setTimeout(typeWriter, pauseTime);
                    return;
                }
                setTimeout(typeWriter, typeSpeed);
            } else {
                // Deleting
                textContent = fullText.substring(0, textContent.length - 1);
                typewriterEl.innerHTML = textContent + '<span class="typewriter-cursor">|</span>';
                distanceEl.style.opacity = '0';
                
                if (textContent === '') {
                    isDeleting = false;
                    currentIndex = (currentIndex + 1) % BEACHES_CONFIG.length;
                    setTimeout(typeWriter, 500);
                    return;
                }
                setTimeout(typeWriter, deleteSpeed);
            }
        }
        
        // Mobile Menu Logic
        function toggleMenu() {
            document.getElementById('navLinks').classList.toggle('active');
        }

        // Image Fallback Logic (Restored)
        function handleImageError(img) {
            img.style.backgroundColor = '#f0f0f0';
            img.style.backgroundImage = 'linear-gradient(135deg, #FFB347 0%, #2E8B57 100%)';
            img.src = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IndoaXRlIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+PHJlY3QgeD0iMyIgeT0iMyIgd2lkdGg9IjE4IiBoZWlnaHQ9IjE4IiByeD0iMiIgcnk9IjIiPjwvcmVjdD48Y2lyY2xlIGN4PSI4LjUiIGN5PSI4LjUiIHI9IjEuNSI+PC9jaXJjbGU+PHBvbHlsaW5lIHBvaW50cz0iMjEgMTUgMTYgMTAgNSAyMSI+PC9wb2x5bGluZT48L3N2Zz4=';
            img.style.objectFit = 'none'; 
            img.style.padding = '30px';
        }

        // Calendar Logic (Matches Latest Backend)
        let startDate, endDate;
        flatpickr("#checkin", {
            minDate: "today",
            onChange: function(d, s) { 
                startDate = s; 
                checkoutPicker.set('minDate', s); 
            }
        });
        let checkoutPicker = flatpickr("#checkout", { minDate: "today", onChange: function(d, s) { endDate = s; } });

        async function checkAvailability() {
            if(!startDate || !endDate) return alert("Please select dates first.");
            
            const btn = document.getElementById("searchBtn");
            const resultArea = document.getElementById("result-area");
            const msg = document.getElementById("status-msg");
            const priceBox = document.getElementById("price-box");

            btn.disabled = true;
            btn.innerText = "Checking...";
            resultArea.style.display = "block"; 
            priceBox.style.display = "none";
            msg.innerText = "Syncing calendars...";
            msg.style.color = "#555";

            try {
                // Pointing to your verified backend function
                const res = await fetch('/.netlify/functions/check-availability', {
                    method: 'POST',
                    body: JSON.stringify({ checkIn: startDate, checkOut: endDate })
                });
                
                const data = await res.json();

                if (data.available) {
                    msg.innerHTML = "Dates are Available! ðŸŽ‰";
                    msg.style.color = "var(--leaf)";
                    priceBox.style.display = "block";
                    
                    // Display pricing from backend
                    document.getElementById("ota-price").innerText = "$" + data.pricing.otaTotal;
                    document.getElementById("direct-price").innerText = "$" + data.pricing.directTotal;
                } else {
                    msg.innerHTML = "Sorry, dates are blocked. ðŸ˜ž";
                    msg.style.color = "#d9534f";
                    
                    if(data.blockedBy && data.blockedBy.length > 0) {
                         msg.innerHTML += `<br><small style='font-size:0.8rem; color:#888'>Blocked by: ${data.blockedBy[0].platform}</small>`;
                    }
                }

            } catch (err) {
                console.error(err);
                msg.innerText = "Error syncing calendars. Please try again.";
            }

            btn.disabled = false;
            btn.innerText = "Check Availability";
        }

        // CAROUSEL LOGIC
        let currentSlide = 0;
        let autoRotateInterval;
        let slides = [];
        let totalSlides = 0;

        function initCarouselOnLoad() {
            // Ensure DOM is ready
            slides = document.querySelectorAll('.carousel-slide');
            totalSlides = slides.length;
            
            if (totalSlides === 0) {
                // Wait a bit and retry
                setTimeout(initCarouselOnLoad, 100);
                return;
            }

            initCarousel();
        }

        function initCarousel() {
            // Set first slide as active
            if (slides.length > 0) {
                updateCarousel();
                
                // Create dots
                const dotsContainer = document.getElementById('dotsContainer');
                if (dotsContainer) {
                    dotsContainer.innerHTML = ''; // Clear existing dots
                    for (let i = 0; i < totalSlides; i++) {
                        const dot = document.createElement('div');
                        dot.className = 'dot' + (i === 0 ? ' active' : '');
                        dot.onclick = () => goToSlide(i);
                        dotsContainer.appendChild(dot);
                    }
                }

                // Start auto-rotation
                startAutoRotate();

                // Pause on hover
                const wrapper = document.querySelector('.carousel-wrapper');
                if (wrapper) {
                    wrapper.addEventListener('mouseenter', stopAutoRotate);
                    wrapper.addEventListener('mouseleave', startAutoRotate);
                }
            }
        }

        function updateCarousel() {
            slides.forEach((slide, index) => {
                slide.classList.remove('active');
            });
            slides[currentSlide].classList.add('active');

            // Update dots
            document.querySelectorAll('.dot').forEach((dot, index) => {
                dot.classList.remove('active');
                if (index === currentSlide) dot.classList.add('active');
            });
        }

        function nextSlide() {
            currentSlide = (currentSlide + 1) % totalSlides;
            updateCarousel();
            resetAutoRotate();
        }

        function prevSlide() {
            currentSlide = (currentSlide - 1 + totalSlides) % totalSlides;
            updateCarousel();
            resetAutoRotate();
        }

        function goToSlide(index) {
            currentSlide = index;
            updateCarousel();
            resetAutoRotate();
        }

        function startAutoRotate() {
            autoRotateInterval = setInterval(nextSlide, 4000);
        }

        function stopAutoRotate() {
            clearInterval(autoRotateInterval);
        }

        function resetAutoRotate() {
            stopAutoRotate();
            startAutoRotate();
        }

        // LIGHTBOX LOGIC
        function openLightbox(imageSrc) {
            const modal = document.getElementById('lightbox-modal');
            const img = document.getElementById('lightbox-image');
            img.src = imageSrc;
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeLightbox() {
            const modal = document.getElementById('lightbox-modal');
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // Close lightbox on escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') closeLightbox();
        });

        // Initialize everything when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                setTimeout(() => {
                    initCarouselOnLoad();
                    if (typeof lucide !== 'undefined') {
                        lucide.createIcons();
                    }
                }, 100);
            });
        } else {
            setTimeout(() => {
                initCarouselOnLoad();
                if (typeof lucide !== 'undefined') {
                    lucide.createIcons();
                }
            }, 100);
        }
</body>
</html>